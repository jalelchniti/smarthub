{
  "rules": {
    ".read": true,
    ".write": true,
    
    "bookings": {
      "$bookingId": {
        ".read": true,
        ".write": true,
        ".validate": "newData.hasChildren(['roomId', 'date', 'timeSlot', 'teacherName', 'subject', 'studentCount', 'duration', 'contactInfo'])",
        
        "paymentStatus": {
          ".validate": "newData.val() == 'pending' || newData.val() == 'paid' || newData.val() == 'cancelled'"
        },
        
        "paymentMethod": {
          ".validate": "newData.val() == 'online' || newData.val() == 'offline'"
        },
        
        "paymentTransactionId": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        
        "paymentTimestamp": {
          ".validate": "newData.isString() && newData.val().matches(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}/)"
        },
        
        "createdAt": {
          ".validate": "newData.isString() && newData.val().matches(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}/)"
        },
        
        "updatedAt": {
          ".validate": "newData.isString() && newData.val().matches(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}/)"
        },
        
        "feeCalculation": {
          "subtotalHT": {
            ".validate": "newData.isNumber() && newData.val() >= 0"
          },
          "vatAmount": {
            ".validate": "newData.isNumber() && newData.val() >= 0"
          },
          "totalTTC": {
            ".validate": "newData.isNumber() && newData.val() >= 0"
          },
          "hourlyRate": {
            ".validate": "newData.isNumber() && newData.val() > 0"
          },
          "vatRate": {
            ".validate": "newData.isNumber() && newData.val() == 0.19"
          }
        },
        
        "roomId": {
          ".validate": "newData.val() == '1' || newData.val() == '2' || newData.val() == '3'"
        },
        
        "studentCount": {
          ".validate": "newData.isNumber() && newData.val() >= 1 && newData.val() <= 15"
        },
        
        "duration": {
          ".validate": "newData.isNumber() && newData.val() >= 0.5 && newData.val() <= 8"
        }
      }
    },
    
    "rooms": {
      ".read": true,
      ".write": false,
      ".validate": false
    },
    
    "timeSlots": {
      ".read": true,
      ".write": false
    },
    
    "weekDays": {
      ".read": true,
      ".write": false
    },
    
    "startDate": {
      ".read": true,
      ".write": false
    },
    
    "lastUpdated": {
      ".read": true,
      ".write": true,
      ".validate": "newData.isString()"
    }
  }
}